<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>e-Kiraana ‚Ä¢ Admin Users</title>
  <link rel="stylesheet" href="style.css">
  <style>
    table{width:100%;border-collapse:collapse}
    th,td{border-bottom:1px solid #e2e8f0;padding:10px;text-align:left;font-size:14px}
    th{font-weight:900;background:#f8fafc}
  </style>
</head>
<body>

<div class="navbar">
  <div class="container inner">
    <div class="brand"><div class="logo">E</div> e-Kiraana</div>
    <div class="nav-actions">
      <a class="btn outline" href="admin.html">Dashboard</a>
      <a class="btn outline" href="admin-stores.html">Stores</a>
      <a class="btn outline" href="admin-orders.html">Orders</a>
      <a class="btn outline" href="admin-categories.html">Categories</a>
    </div>
  </div>
</div>

<div class="container">
  <div class="hero">
    <h1>All Users üë•</h1>
    <p>View all registered users.</p>
  </div>

  <div class="card">
    <div class="title">Users List</div>
    <div class="small">Auto loaded from sheet.</div>
    <hr>
    <div style="overflow:auto">
      <table id="tbl">
        <thead>
          <tr>
            <th>User ID</th>
            <th>Username</th>
            <th>Password</th>
            <th>Role</th>
            <th>Phone</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
  </div>
</div>

<div class="toast" id="toast">Loaded ‚úÖ</div>

<script>
const API="https://script.google.com/macros/s/AKfycbwnE6rvhunQy8pbs5y_N7kjjSW5hf58ypxg24nmSO5LzMmxEOajlXc1uY6IMjGO0Uo/exec";
function api(params){
  const url = API + "?" + new URLSearchParams(params).toString();
  return fetch(url).then(r=>r.json());
}
function toast(text,type="green"){
  const t=document.getElementById("toast");
  t.textContent=text;
  t.style.background=(type==="red")?"#ef4444":(type==="yellow")?"#f59e0b":"#16a34a";
  t.style.display="block";
  setTimeout(()=>t.style.display="none",1500);
}

const role = localStorage.getItem("role");
if(role!=="admin") location.href="index.html";

function loadUsers(){
  api({action:"adminUsers"})
  .then(rows=>{
    const tb=document.querySelector("#tbl tbody");
    tb.innerHTML="";
    for(let i=1;i<rows.length;i++){
      const r=rows[i];
      tb.innerHTML += `
        <tr>
          <td>${r[0]||""}</td>
          <td>${r[1]||""}</td>
          <td>${r[2]||""}</td>
          <td><b>${r[3]||""}</b></td>
          <td>${r[4]||""}</td>
        </tr>
      `;
    }
    toast("Users loaded ‚úÖ");
  })
  .catch(err=>{
    console.error(err);
    toast("Server error ‚ùå","red");
  });
}
loadUsers();
</script>

<div class="footer-space"></div>
</body>
</html>
